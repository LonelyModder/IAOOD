namespace = plague_event

plague_event.1 = { 
	type = country_event
	title = "plague_event.1.t"
	desc = "plague_event.1.desc"
	picture = religious_rite
	
	immediate = {
		random_province = {
			add_province_modifier = {
				name = plagued_territory
			}
		}
		set_global_variable = {
			name = plague_began
		}
		trigger_event = {
			id = plague_event.5
			days = { 178 1095 }
		}
	}
	
	option = {
		name = plague_event.1.a
	}
}

plague_event.2 = { 
	type = province_event
	hidden = yes
	
	immediate = {
		#every_province = {
			if = {
				limit = {
					any_neighbor_province = { has_province_modifier = plagued_territory }
				}
				add_province_modifier = {
					name = sick_territory
				}
			}
		#}
	}
}

plague_event.3 = { 
	type = province_event
	hidden = yes
	
	immediate = {
		#every_province = {
			if = {
				limit = {
					any_neighbor_province = { has_province_modifier = sick_territory }
				}
				add_province_modifier = {
					name = plagued_territory
				}
			}
		#}
	}
}

plague_event.4 = { 
	type = province_event
	hidden = yes
	
	immediate = {
		#every_province = {
			if = {
				limit = {
					has_province_modifier = plagued_territory
				}
				while = { 
					count = 2
					limit = { 
						total_population > 4 
					} 
					random_pops_in_province = { 
						kill_pop = yes 
					}
				}
			}
		#}
	}
}

plague_event.5 = { 
	type = province_event
	hidden = yes
	
	trigger = {
		has_variable = plague_began
	}
	
	immediate = {
		#every_province = {
			if = {
				limit = {
					any_neighbor_province = { has_province_modifier = sick_territory }
				}
				add_province_modifier = {
					name = immune_territory
					duration = 365
				}
			}
		#}
	}
}